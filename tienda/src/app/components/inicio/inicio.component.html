<app-nav></app-nav>

<main class="cs-page-wrapper">
    <!-- ============================================ -->
    <!-- CARRUSEL PRINCIPAL CON DESCUENTO ACTIVO -->
    <!-- ============================================ -->
    <section class="cs-carousel cs-controls-onhover">
        <div class="cs-carousel-inner" data-carousel-options=''>
    
          <!-- Slide 1 - Descuento Activo (SOLO SI EXISTE) -->
          <div *ngIf="descuento_activo && !load_descuento" 
               class="bg-size-cover py-xl-6" 
               [style.background-image]="'url(' + url + 'obtener_banner_descuento/' + descuento_activo.banner + ')'">
            <div class="container pt-5 pb-6">
              <div class="row pb-lg-6">
                <div class="col-lg-6 offset-lg-1 offset-xl-0 pb-4 pb-md-6">
                  <h3 class="font-size-lg text-uppercase cs-from-left cs-delay-1">
                    {{ formatear_fecha_descuento() }}
                  </h3>
                  <h2 class="display-2 mb-lg-5 pb-3 cs-from-left">
                    {{ descuento_activo.titulo }} - {{ descuento_activo.descuento }}% OFF
                  </h2>
                  <div class="mb-4 cs-scale-up cs-delay-2">
                    <a [routerLink]="['/productos']" class="btn btn-outline-primary btn-lg">
                      Comprar ahora
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          <!-- Slide 2 - Nueva Colección -->
          <div class="bg-size-cover py-xl-6" 
               style="background-image: url(../../../assets/img/ecommerce/home/hero-slider/01.jpg);">
            <div class="container pt-5 pb-6">
              <div class="row pb-lg-6">
                <div class="col-lg-6 offset-lg-1 offset-xl-0 pb-4 pb-md-6">
                  <h3 class="font-size-lg text-uppercase cs-from-left cs-delay-1">Nueva Colección</h3>
                  <h2 class="display-2 mb-lg-5 pb-3 cs-from-left">Moda Masculina 2025</h2>
                  <div class="mb-4 cs-scale-up cs-delay-2">
                    <a [routerLink]="['/productos']" class="btn btn-outline-primary btn-lg">
                      Ver colección
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          <!-- Slide 3 - Temporada -->
          <div class="bg-size-cover py-xl-6" 
               style="background-image: url(../../../assets/img/ecommerce/home/hero-slider/02.jpg);">
            <div class="container pt-5 pb-6">
              <div class="row pb-lg-6">
                <div class="col-lg-6 offset-lg-1 offset-xl-0 pb-4 pb-md-6">
                  <h3 class="font-size-lg text-uppercase cs-from-top cs-delay-1">Nueva Temporada</h3>
                  <h2 class="display-2 mb-lg-5 pb-3 cs-scale-down">Otoño-Invierno 2025</h2>
                  <div class="mb-4 cs-scale-down cs-delay-2">
                    <a [routerLink]="['/productos']" class="btn btn-outline-primary btn-lg">
                      Explorar ahora
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          <!-- Slide 4 - Ofertas -->
          <div class="bg-size-cover py-xl-6" 
               style="background-image: url(../../../assets/img/ecommerce/home/hero-slider/04.jpg);">
            <div class="container pt-5 pb-6">
              <div class="row pb-lg-6">
                <div class="col-lg-6 offset-lg-1 offset-xl-0 pb-4 pb-md-6">
                  <h3 class="font-size-lg text-uppercase cs-from-top cs-delay-1">Mejores Precios</h3>
                  <h2 class="display-2 mb-lg-5 pb-3 cs-scale-down">Ofertas Especiales</h2>
                  <div class="mb-4 cs-scale-down cs-delay-2">
                    <a [routerLink]="['/productos']" class="btn btn-outline-primary btn-lg">
                      Ver ofertas
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    
        <!-- Paginador -->
        <div class="container position-relative">
          <div class="row mt-lg-n5">
            <div class="col-lg-7 col-md-8 col-sm-10 offset-lg-1 offset-xl-0">
              <div class="position-relative">
                <div id="pager" class="cs-pager cs-pager-inverse mb-xl-5 pb-5 pb-md-6">
                  <button *ngIf="descuento_activo" type="button" data-nav="0">01</button>
                  <button type="button" [attr.data-nav]="descuento_activo ? '1' : '0'">
                    {{ descuento_activo ? '02' : '01' }}
                  </button>
                  <button type="button" [attr.data-nav]="descuento_activo ? '2' : '1'">
                    {{ descuento_activo ? '03' : '02' }}
                  </button>
                  <button type="button" [attr.data-nav]="descuento_activo ? '3' : '2'">
                    {{ descuento_activo ? '04' : '03' }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
    </section>

    <!-- ============================================ -->
    <!-- CATEGORÍAS PRINCIPALES -->
    <!-- ============================================ -->
    <section class="container pt-5 pt-lg-0">
        <div class="cs-carousel cs-nav-outside">
          <div class="cs-carousel-inner cs-carousel-inner-two" data-carousel-options=''>
            
            <!-- Categoría Mujer -->
            <a [routerLink]="['/productos']" 
               class="d-block cs-image-scale cs-heading-highlight text-center">
              <div class="cs-image-inner mb-3 rounded">
                <img src="assets/img/ecommerce/home/categories/01.jpg" alt="Mujer">
              </div>
              <h3 class="h5 mb-1">Mujer</h3>
            </a>

            <!-- Categoría Hombre -->
            <a [routerLink]="['/productos']"
               class="d-block cs-image-scale cs-heading-highlight text-center">
              <div class="cs-image-inner mb-3 rounded">
                <img src="assets/img/ecommerce/home/categories/02.jpg" alt="Hombre">
              </div>
              <h3 class="h5 mb-1">Hombre</h3>
            </a>

            <!-- Categoría Niños -->
            <a [routerLink]="['/productos']"
               class="d-block cs-image-scale cs-heading-highlight text-center">
              <div class="cs-image-inner mb-3 rounded">
                <img src="assets/img/ecommerce/home/categories/03.jpg" alt="Niños">
              </div>
              <h3 class="h5 mb-1">Niños</h3>
            </a>

          </div>
        </div>
    </section>

    <!-- ============================================ -->
    <!-- NUEVOS PRODUCTOS -->
    <!-- ============================================ -->
    <section class="container-fluid px-xl-grid-gutter mt-5 mb-3 mb-sm-4 mt-md-0 mb-lg-5 py-5 py-lg-6">
        <div class="text-center mb-5 pb-2">
          <h2 class="h1">Nuevos Productos</h2>
          <p class="font-size-lg text-muted mb-1">Descubre nuestros últimos productos agregados</p>
          <a [routerLink]="['/productos']" class="font-size-lg">Ver toda la colección aquí</a>
        </div>

        <!-- Loading -->
        <div *ngIf="load_nuevos" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Cargando...</span>
          </div>
        </div>

        <!-- Carrusel de productos -->
        <div *ngIf="!load_nuevos && nuevos_productos.length > 0" 
             class="cs-carousel cs-nav-outside">
          <div class="cs-carousel-inner cs-carousel-inner-three" data-carousel-options='{}'>

            <!-- Item de producto -->
            <div *ngFor="let producto of nuevos_productos">
              <div class="card card-product">
                <div class="card-product-img">
                  <a [routerLink]="['/productos', producto.slug]" class="card-img-top">
                    <img [src]="url + 'obtener_portada/' + producto.portada" 
                         [alt]="producto.titulo"
                         class="img-fluid">
                  </a>
                  
                  <!-- Rating -->
                  <div class="card-product-widgets-top" *ngIf="producto.npuntos > 0">
                    <div class="star-rating">
                      <i *ngFor="let estrella of generar_estrellas(producto.npuntos)" 
                         class="sr-star cxi-star-filled"
                         [class.active]="estrella"></i>
                    </div>
                  </div>
                </div>

                <div class="card-body">
                  <h3 class="card-product-title text-truncate mb-2">
                    <a [routerLink]="['/productos', producto.slug]" class="nav-link">
                      {{ producto.titulo }}
                    </a>
                  </h3>
                  
                  <div class="d-flex align-items-center">
                    <!-- Precio con descuento -->
                    <span *ngIf="descuento_activo" class="h5 d-inline-block mb-0 text-primary mr-2">
                      ${{ calcular_precio_con_descuento(producto.precio) }}
                    </span>
                    
                    <!-- Precio original -->
                    <span class="h5 d-inline-block mb-0" 
                          [class.text-muted]="descuento_activo"
                          [class.text-decoration-line-through]="descuento_activo">
                      ${{ producto.precio }}
                    </span>
                    
                    <!-- Badge de descuento -->
                    <span *ngIf="descuento_activo" 
                          class="badge badge-danger ml-2">
                      -{{ descuento_activo.descuento }}%
                    </span>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Sin productos -->
        <div *ngIf="!load_nuevos && nuevos_productos.length === 0" 
             class="text-center py-5">
          <p class="text-muted">No hay productos disponibles en este momento</p>
        </div>
    </section>

    <!-- ============================================ -->
    <!-- PRODUCTOS EN TENDENCIA -->
    <!-- ============================================ -->
    <section class="py-5" style="background-color: #e5e8ed;">
        <div class="container my-lg-2 py-2 py-md-4">
          <div class="d-flex align-items-center justify-content-between pb-sm-1 mb-5">
            <h2 class="h1 mb-0">En Tendencia</h2>
            <div class="tns-custom-controls cs-controls-inverse" 
                 id="custom-controls-trending" 
                 tabindex="0">
              <button type="button" data-controls="prev" tabindex="-1">
                <i class="cxi-arrow-left"></i>
              </button>
              <button type="button" data-controls="next" tabindex="-1">
                <i class="cxi-arrow-right"></i>
              </button>
            </div>
          </div>

          <!-- Loading -->
          <div *ngIf="load_tendencia" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="sr-only">Cargando...</span>
            </div>
          </div>

          <!-- Carrusel -->
          <div *ngIf="!load_tendencia && productos_tendencia.length > 0" 
               class="cs-carousel pb-2">
            <div class="cs-carousel-inner cs-carousel-inner-four" data-carousel-options='{}'>

              <!-- Item de producto -->
              <div *ngFor="let producto of productos_tendencia">
                <div class="card card-product mx-auto">
                  <div class="card-product-img">
                    <a [routerLink]="['/productos', producto.slug]" class="card-img-top">
                      <img [src]="url + 'obtener_portada/' + producto.portada" 
                           [alt]="producto.titulo"
                           class="img-fluid">
                    </a>
                    
                    <!-- Rating -->
                    <div class="card-product-widgets-top" *ngIf="producto.npuntos > 0">
                      <div class="star-rating ml-auto">
                        <i *ngFor="let estrella of generar_estrellas(producto.npuntos)" 
                           class="sr-star cxi-star-filled"
                           [class.active]="estrella"></i>
                      </div>
                    </div>

                    <!-- Badge de ventas -->
                    <div class="card-product-label" *ngIf="producto.nventas > 0">
                      <span class="badge badge-success">
                        {{ producto.nventas }} vendidos
                      </span>
                    </div>
                  </div>

                  <div class="card-body bg-0 pb-2">
                    <h3 class="card-product-title text-truncate mb-2">
                      <a [routerLink]="['/productos', producto.slug]" class="nav-link">
                        {{ producto.titulo }}
                      </a>
                    </h3>
                    
                    <div class="d-flex align-items-center">
                      <!-- Precio con descuento -->
                      <span *ngIf="descuento_activo" class="h5 d-inline-block mb-0 text-primary mr-2">
                        ${{ calcular_precio_con_descuento(producto.precio) }}
                      </span>
                      
                      <!-- Precio original -->
                      <span class="h5 d-inline-block mb-0" 
                            [class.text-muted]="descuento_activo"
                            [class.text-decoration-line-through]="descuento_activo">
                        ${{ producto.precio }}
                      </span>
                      
                      <!-- Badge de descuento -->
                      <span *ngIf="descuento_activo" 
                            class="badge badge-danger ml-2">
                        -{{ descuento_activo.descuento }}%
                      </span>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>

          <!-- Botón ver más -->
          <div class="text-center pt-4 pt-md-5">
            <a [routerLink]="['/productos']" class="btn btn-outline-primary btn-lg">
              Explorar más vendidos
            </a>
          </div>
        </div>
    </section>

    <!-- ============================================ -->
    <!-- CATEGORÍAS POPULARES -->
    <!-- ============================================ -->
<section class="container mt-1 mb-3 my-sm-4 py-5 py-lg-6" id="categorias">
    <h2 class="h1 mb-5 pb-3 text-center">Categorías Populares</h2>

    <!-- Loading -->
    <div *ngIf="load_categorias" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="sr-only">Cargando...</span>
      </div>
    </div>

    <!-- Carrusel de categorías con redirección correcta -->
    <div *ngIf="!load_categorias && categorias.length > 0" 
         class="cs-carousel cs-nav-outside">
      <div class="cs-carousel-inner cs-carousel-inner-five" data-carousel-options='{}'>

        <!-- Categoría con redirección correcta -->
        <div *ngFor="let categoria of categorias" class="pb-2">
          <a [routerLink]="['/productos/categoria', categoria.titulo.toLowerCase()]" 
             class="d-block cs-image-scale cs-heading-highlight text-center">
            <div class="cs-image-inner rounded-circle mx-auto mb-4 bg-light d-flex align-items-center justify-content-center" 
                 style="width: 180px; height: 180px;">
              <i [class]="categoria.icono" 
                 style="font-size: 4rem; color: #6c5ce7;"></i>
            </div>
            <h3 class="h5 mb-3">{{ categoria.titulo }}</h3>
          </a>
        </div>

      </div>
    </div>

    <!-- Sin categorías -->
    <div *ngIf="!load_categorias && categorias.length === 0" 
         class="text-center py-5">
      <p class="text-muted">No hay categorías disponibles</p>
    </div>
</section>


<!-- ============================================ -->
<!-- CARACTERÍSTICAS DEL SERVICIO -->
<!-- ============================================ -->
<section class="container pt-5 pb-2 pb-sm-5 py-md-5 py-lg-6">
  <div class="row py-3">

    <div class="col-sm-6 col-md-3 servicio-item">
      <img class="mb-4" src="assets/img/ecommerce/home/services/delivery.svg" width="48" alt="Envíos rápidos">
      <h5 class="h5 mb-2">Envíos a Todo El Salvador</h5>
      <p class="mb-0 text-muted">Entrega rápida y segura en todo el país</p>
    </div>

    <div class="col-sm-6 col-md-3 servicio-item">
      <img class="mb-4" src="assets/img/ecommerce/home/services/support.svg" width="48" alt="Soporte">
      <h5 class="h5 mb-2">Soporte Personalizado</h5>
      <p class="mb-0 text-muted">Asistencia directa de TenGo Market</p>
    </div>

    <div class="col-sm-6 col-md-3 servicio-item">
      <img class="mb-4" src="assets/img/ecommerce/home/services/guarantee.svg" width="48" alt="Garantía">
      <h5 class="h5 mb-2">Compras Garantizadas</h5>
      <p class="mb-0 text-muted">Política de devolución flexible</p>
    </div>

    <div class="col-sm-6 col-md-3 servicio-item">
      <img class="mb-4" src="assets/img/ecommerce/home/services/payment.svg" width="48" alt="Pago seguro">
      <h5 class="h5 mb-2">Pago Seguro</h5>
      <p class="mb-0 text-muted">Métodos de pago confiables</p>
    </div>

  </div>
</section>


    <!-- ============================================ -->
    <!-- CALL TO ACTION - APLICACIÓN MÓVIL -->
    <!-- ============================================ -->
    <section class="bg-dark">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-md-5">
              <img src="assets/img/ecommerce/home/mobile-app-illustration.png" 
                   class="d-block mx-auto my-4 mb-lg-0 mt-lg-n4" 
                   width="498" 
                   alt="Ilustración">
            </div>
            <div class="col-md-7 col-lg-6 pt-3 pb-5 pt-md-5 pb-md-4 ml-auto">
              <h2 class="text-light text-center text-md-left pb-3">
                ¡Disfruta de comprar desde nuestra aplicación móvil!
              </h2>
              <div class="d-flex flex-wrap flex-sm-nowrap justify-content-center justify-content-md-start">
                <a href="#" class="btn-market btn-apple mb-3 mx-2 ml-md-0 mr-md-3" role="button">
                  <span class="btn-market-subtitle">Descargar en</span>
                  <span class="btn-market-title">App Store</span>
                </a>
                <a href="#" class="btn-market btn-google mb-3 mx-2 mx-md-0" role="button">
                  <span class="btn-market-subtitle">Descargar en</span>
                  <span class="btn-market-title">Google Play</span>
                </a>
              </div>
            </div>
          </div>
        </div>
    </section>

    <!-- ============================================ -->
    <!-- INSTAGRAM -->
    <!-- ============================================ -->
    <section class="pt-5 pb-4 pt-lg-6 pb-lg-5 border-top border-bottom">
        <div class="container pt-md-4 pb-2 pt-lg-0 pb-lg-0">
          <div class="row">
            <div class="col-md-4 text-center text-md-left pb-2 pb-md-0 mb-4 mb-md-0">
              <p class="text-dark text-uppercase mb-2">Síguenos en Instagram</p>
              <h2 class="h1 pb-2 pb-md-3">@tengo.todomarket</h2>
              <a href="https://www.instagram.com/tengo.todomarket/?hl=es" class="btn btn-outline-primary btn-lg">
                <i class="cxi-instagram font-size-lg mr-1"></i>
                Seguir en Instagram
              </a>
            </div>
          </div>
        </div>
    </section>
</main>

<app-footer></app-footer>